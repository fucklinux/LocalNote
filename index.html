<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
    <link rel="stylesheet" href="mdui-v1.0.2/css/mdui.min.css">
    <script src="mdui-v1.0.2/js/mdui.min.js"></script>
    <link rel="shortcut icon" href="favicon.png" type="image/x-icon">
    <title>备忘录</title>
    <style>
        .mdui-select {
            width: 100%;
        }
    </style>
</head>

<body class="mdui-theme-primary-indigo mdui-theme-accent-pink mdui-drawer-body-left mdui-theme-layout-auto">
    <div class="mdui-appbar mdui-appbar-inset">
        <div class="mdui-toolbar mdui-color-theme">
            <a class="mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-drawer="{target: '#drawer', swipe: true}">
                <i class="mdui-icon material-icons">menu</i>
            </a>
            <a class="mdui-typo-title">备忘录</a>
            <div class="mdui-toolbar-spacer"></div>
            <a class="mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-tooltip="{content: '删除'}" style="display: none;" id="delete" mdui-dialog="{target: '#deleting'}">
                <i class="mdui-icon material-icons">delete</i>
            </a>
            <a class="mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-tooltip="{content: '星标'}" style="display: none;" id="star">
                <i class="mdui-icon material-icons" id="starIcon" onclick="javascript:starNote();">star_border</i>
            </a>
            <a class="mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-tooltip="{content: '新建'}" onclick="javascript:newNote();">
                <i class="mdui-icon material-icons">add</i>
            </a>
            <a class="mdui-btn mdui-btn-icon mdui-ripple mdui-ripple-white" mdui-tooltip="{content: '夜间模式'}" onclick="javascript:darkMode();">
                <i class="mdui-icon material-icons">brightness_medium</i>
            </a>
        </div>
    </div>
    <div class="mdui-drawer mdui-drawer-full-height" id="drawer" style="transition: all 0.3s cubic-bezier(0, 0, 0.2, 1);">
        <ul class="mdui-list" id="noteList" style="width: 100%;"></ul>
        <div id="guide" style="width: 100%;text-align: center;">
            <div class="mdui-typo-body-2 mdui-text-center mdui-m-b-1">没有可显示的内容</div>
            <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent" onclick="javascript:newNote();">新建备忘录</button>
        </div>
    </div>
    <div id="choose"><button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent mdui-center" style="margin: 16px;" onclick="javascript:new mdui.Drawer('#drawer', {swipe: true}).open();">选择一条备忘录</button></div>
    <form class="mdui-center" style="padding: 16px;max-width: 640px;">
        <div onclick="javascript:loadType();" style="padding: 8px;transition: 0.2s;" id="selectDiv">
            <select class="mdui-select" mdui-select>
                <option id="travel">旅游</option>
                <option id="person">个人</option>
                <option id="life">生活</option>
                <option id="work">工作</option>
                <option id="none" selected>未分类</option>
            </select>
        </div>
        <div class="mdui-textfield">
            <label class="mdui-textfield-label">标题</label>
            <input class="mdui-textfield-input" type="text" id="title" />
        </div>
        <div class="mdui-textfield">
            <label class="mdui-textfield-label">内容</label>
            <textarea class="mdui-textfield-input" type="text" id="content"></textarea>
        </div>
        <div class="mdui-textfield">
            <label class="mdui-textfield-label">修改日期</label>
            <input class="mdui-textfield-input" type="text" id="date" disabled />
        </div>
    </form>
    <button class="mdui-btn mdui-btn-raised mdui-ripple mdui-color-theme-accent mdui-center" onclick="javascript:saveNote('snackBar');" id="save" disabled="disabled">保存</button>
    <div class="mdui-typo-body-2 mdui-text-center mdui-m-t-2">Made by Burger Studio.</div>
    <div class="mdui-dialog" id="deleting">
        <div class="mdui-dialog-title">删除此备忘录？</div>
        <div class="mdui-dialog-content">这将使你丢失它的全部数据。</div>
        <div class="mdui-dialog-actions">
            <button class="mdui-btn mdui-ripple" mdui-dialog-close>取消</button>
            <button class="mdui-btn mdui-ripple" onclick="javascript:deleteNote();" mdui-dialog-close>确定</button>
        </div>
    </div>
    <script>
        var drawer = document.getElementById('drawer');
        var guide = document.getElementById('guide');
        var noteList = document.getElementById('noteList');
        var editing = "";
        var title = document.getElementById('title');
        var content = document.getElementById('content');
        var deletebtn = document.getElementById('delete');
        var star = document.getElementById('star');
        var starIcon = document.getElementById('starIcon');
        var date = document.getElementById('date');
        var save = document.getElementById('save');
        var choose = document.getElementById('choose');
        var selectDiv = document.getElementById('selectDiv');
        if (localStorage.notes) {
            showButtons1();
            loadNotes();
        } else {
            hideButtons1();
        }

        function newNote() {
            if (localStorage.notes) {
                localStorage.setItem("notes", Number(localStorage.getItem("notes")) + 1);
            } else {
                localStorage.setItem("notes", 0);
            }
            showButtons1();
            showButtons2();
            localStorage.setItem("noteTitle" + localStorage.getItem("notes"), "备忘录 " + Number(Number(localStorage.getItem("notes")) + 1));
            localStorage.setItem("noteContent" + localStorage.getItem("notes"), "");
            localStorage.setItem("noteStared" + localStorage.getItem("notes"), "false");
            localStorage.setItem("noteDeleted" + localStorage.getItem("notes"), "false");
            getNowDate();
            localStorage.setItem("noteDate" + localStorage.getItem("notes"), formattedDate);
            localStorage.setItem("noteType" + localStorage.getItem("notes"), "none");
            loadNotes();
            editing = localStorage.getItem("notes");
            editNote();
        }

        function loadNotes() {
            var noteListItems = "";
            var notes = 0;
            for (i = 0; i <= localStorage.getItem("notes"); i++) {
                noteListItems += "<li class='mdui-list-item mdui-ripple mdui-ripple-black' name='noteListItems' id='" + i + "'><i class='mdui-list-item-icon mdui-icon material-icons' name='noteIcons'>edit</i><div class='mdui-list-item-content'>" + localStorage.getItem("noteTitle" + i) + "</div></li>";
                noteList.innerHTML = noteListItems;
            }
            for (i = 0; i <= localStorage.getItem("notes"); i++) {
                if (localStorage.getItem("noteStared" + i) == "true") {
                    document.getElementsByName("noteIcons")[i].innerHTML = "star";
                    document.getElementsByName("noteIcons")[i].classList.add("mdui-text-color-amber");
                }
                if (localStorage.getItem("noteDeleted" + i) == "true") {
                    document.getElementsByName("noteListItems")[i].style.display = "none";
                }
                document.getElementsByName("noteListItems")[i].addEventListener("click", function() {
                    editing = this.id;
                    editNote();
                });
                if (localStorage.getItem("noteDeleted" + i) != "true") {
                    notes += 1;
                }
                type = localStorage.getItem("noteType" + i);
                if (type == "travel") {
                    document.getElementsByName("noteListItems")[i].classList.add("mdui-color-yellow-100");
                }
                if (type == "person") {
                    document.getElementsByName("noteListItems")[i].classList.add("mdui-color-blue-100");
                }
                if (type == "life") {
                    document.getElementsByName("noteListItems")[i].classList.add("mdui-color-green-100");
                }
                if (type == "work") {
                    document.getElementsByName("noteListItems")[i].classList.add("mdui-color-red-100");
                }
                if (type == "none" || type == "") {
                    document.getElementsByName("noteListItems")[i].classList.remove("mdui-ripple-black");
                }
            }
            if (editing != "") {
                document.getElementsByName("noteListItems")[editing].classList.add("mdui-list-item-active");
                document.getElementsByName("noteListItems")[editing].classList.add("mdui-color-" + color + "-200");
            }
            if (notes == 0) {
                hideButtons1();
            }
        }

        function editNote() {
            showButtons2();
            title.value = localStorage.getItem("noteTitle" + editing);
            content.value = localStorage.getItem("noteContent" + editing);
            content.focus();
            content.blur();
            date.value = localStorage.getItem("noteDate" + editing);
            for (i = 0; i <= localStorage.getItem("notes"); i++) {
                type = localStorage.getItem("noteType" + i);
                if (type == "travel") {
                    colour = "yellow";
                }
                if (type == "person") {
                    colour = "blue";
                }
                if (type == "life") {
                    colour = "green";
                }
                if (type == "work") {
                    colour = "red";
                }
                if (type == "none" || type == null) {
                    colour = "";
                }
                if (i == editing) {
                    document.getElementsByName("noteListItems")[i].classList.add("mdui-list-item-active");
                    document.getElementsByName("noteListItems")[i].classList.remove("mdui-color-yellow-100", "mdui-color-blue-100", "mdui-color-green-100", "mdui-color-red-100");
                    document.getElementsByName("noteListItems")[i].classList.add("mdui-color-" + colour + "-200");
                } else {
                    document.getElementsByName("noteListItems")[i].classList.remove("mdui-list-item-active", "mdui-color-yellow-200", "mdui-color-blue-200", "mdui-color-green-200", "mdui-color-red-200");
                    document.getElementsByName("noteListItems")[i].classList.add("mdui-color-" + colour + "-100");
                }
            }
            if (localStorage.getItem("noteStared" + editing) == "true") {
                starIcon.innerHTML = "star";
            } else {
                starIcon.innerHTML = "star_border";
            }
            selectItem(localStorage.getItem("noteType" + editing));
            if (document.body.clientWidth < 1024 && document.getElementsByClassName("mdui-overlay")[0] != undefined) {
                new mdui.Drawer("#drawer", {
                    swipe: true
                }).close();
                document.getElementsByClassName("mdui-overlay")[0].click();
            }
        }

        function saveNote(options) {
            localStorage.setItem("noteTitle" + editing, title.value);
            localStorage.setItem("noteContent" + editing, content.value);
            getNowDate();
            localStorage.setItem("noteDate" + editing, formattedDate);
            if (options == "snackBar") {
                mdui.snackbar("已保存");
            }
            loadNotes();
            editNote();
        }

        function starNote() {
            if (localStorage.getItem("noteStared" + editing) == "true") {
                localStorage.setItem("noteStared" + editing, "false");
                mdui.snackbar("已取消星标");
                starIcon.innerHTML = "star_border";
            } else {
                localStorage.setItem("noteStared" + editing, "true");
                mdui.snackbar("已设为星标");
                starIcon.innerHTML = "star";
            }
            loadNotes();
        }

        function deleteNote() {
            localStorage.removeItem("noteTitle" + editing);
            localStorage.removeItem("noteContent" + editing);
            localStorage.removeItem("noteStared" + editing);
            localStorage.setItem("noteDeleted" + editing, "true");
            localStorage.removeItem("noteDate" + editing);
            localStorage.removeItem("noteType" + editing);
            mdui.snackbar("已删除");
            loadNotes();
            hideButtons2();
            editing = "";
        }

        function showButtons1() {
            drawer.classList.remove("mdui-valign");
            guide.style.display = "none";
            noteList.style.display = "block";
        }

        function showButtons2() {
            choose.style.display = "none";
            deletebtn.style.display = "block";
            star.style.display = "block";
            save.disabled = "";
        }

        function hideButtons1() {
            drawer.classList.add("mdui-valign");
            guide.style.display = "block";
            noteList.style.display = "none";
        }

        function hideButtons2() {
            choose.style.display = "block";
            deletebtn.style.display = "none";
            star.style.display = "none";
            save.disabled = "disabled";
        }
        typeLoaded = 0;

        function loadType() {
            autoSettingType = 0;
            if (typeLoaded != 1) {
                document.getElementsByClassName("mdui-select-menu-item")[0].classList.add("mdui-color-yellow-100", "mdui-ripple-black");
                document.getElementsByClassName("mdui-select-menu-item")[1].classList.add("mdui-color-blue-100", "mdui-ripple-black");
                document.getElementsByClassName("mdui-select-menu-item")[2].classList.add("mdui-color-green-100", "mdui-ripple-black");
                document.getElementsByClassName("mdui-select-menu-item")[3].classList.add("mdui-color-red-100", "mdui-ripple-black");
                document.getElementsByClassName("mdui-select-menu-item")[0].addEventListener("click", function() {
                    setNoteType("travel");
                });
                document.getElementsByClassName("mdui-select-menu-item")[1].addEventListener("click", function() {
                    setNoteType("person");
                });
                document.getElementsByClassName("mdui-select-menu-item")[2].addEventListener("click", function() {
                    setNoteType("life");
                });
                document.getElementsByClassName("mdui-select-menu-item")[3].addEventListener("click", function() {
                    setNoteType("work");
                });
                document.getElementsByClassName("mdui-select-menu-item")[4].addEventListener("click", function() {
                    setNoteType("none");
                });
            }
            typeLoaded = 1;
        }

        function setNoteType(type) {
            if (editing != "" && autoSettingType == 0) {
                if (type == "travel") {
                    localStorage.setItem("noteType" + editing, "travel");
                    mdui.snackbar("已分类至“旅游“");
                }
                if (type == "person") {
                    localStorage.setItem("noteType" + editing, "person");
                    mdui.snackbar("已分类至“个人“");
                }
                if (type == "life") {
                    localStorage.setItem("noteType" + editing, "life");
                    mdui.snackbar("已分类至“生活“");
                }
                if (type == "work") {
                    localStorage.setItem("noteType" + editing, "work");
                    mdui.snackbar("已分类至“工作“");
                }
                if (type == "none") {
                    localStorage.setItem("noteType" + editing, "none");
                    mdui.snackbar("已分类至“未分类“");
                }
                saveNote();
                document.getElementsByName("noteListItems")[editing].classList.remove("mdui-color-yellow-100", "mdui-color-blue-100", "mdui-color-green-100", "mdui-color-red-100", "mdui-color-yellow-200", "mdui-color-blue-200", "mdui-color-green-200", "mdui-color-red-200");
                editNote();
                selectItem(type);
            }
        }

        function selectItem(type) {
            if (type == "travel") {
                color = "yellow";
                i = 0;
            }
            if (type == "person") {
                color = "blue";
                i = 1;
            }
            if (type == "life") {
                color = "green";
                i = 2;
            }
            if (type == "work") {
                color = "red";
                i = 3;
            }
            if (type == "none" || type == "") {
                color = "";
                i = 4;
            }
            selectDiv.classList.remove("mdui-color-yellow-100", "mdui-color-blue-100", "mdui-color-green-100", "mdui-color-red-100");
            selectDiv.classList.add("mdui-color-" + color + "-100");
            autoSettingType = 1;
            document.getElementsByClassName("mdui-select-menu-item")[i].click();
        }

        function darkMode() {
            if (localStorage.getItem("darkMode") == "true") {
                localStorage.setItem("darkMode", "false");
                document.body.classList.remove("mdui-theme-layout-dark");
            } else {
                localStorage.setItem("darkMode", "true");
                document.body.classList.add("mdui-theme-layout-dark");
            }
        }
        if (localStorage.getItem("darkMode") == "true") {
            document.body.classList.add("mdui-theme-layout-dark");
        }

        function getNowDate() {
            nowDate = new Date();
            year = nowDate.getFullYear();
            month = Number(nowDate.getMonth() + 1);
            if (month < 10) {
                month = "0" + month;
            }
            day = nowDate.getDate();
            if (day < 10) {
                day = "0" + day;
            }
            hours = nowDate.getHours();
            if (hours < 10) {
                hours = "0" + hours;
            }
            minutes = nowDate.getMinutes();
            if (minutes < 10) {
                minutes = "0" + minutes;
            }
            seconds = nowDate.getSeconds();
            if (seconds < 10) {
                seconds = "0" + seconds;
            }
            formattedDate = year + "/" + month + "/" + day + " " + hours + ":" + minutes + ":" + seconds;
        }
    </script>
</body>

</html>